Device cuda
Loading csv... done, took 1.1s
Parsing... done, took 0.3s
Entropy of Cup98([Column(473, distribution_size=2), Column(5, distribution_size=3), Column(9, distribution_size=3), Column(10, distribution_size=3), Column(11, distribution_size=3), Column(12, distribution_size=3), Column(52, distribution_size=3), Column(55, distribution_size=3), Column(56, distribution_size=3), Column(57, distribution_size=3), Column(58, distribution_size=3), Column(59, distribution_size=3), Column(60, distribution_size=3), Column(61, distribution_size=3), Column(62, distribution_size=3), Column(63, distribution_size=3), Column(64, distribution_size=3), Column(65, distribution_size=3), Column(66, distribution_size=3), Column(67, distribution_size=3), Column(68, distribution_size=3), Column(69, distribution_size=3), Column(70, distribution_size=3), Column(71, distribution_size=3), Column(72, distribution_size=3), Column(74, distribution_size=3), Column(6, distribution_size=4), Column(17, distribution_size=4), Column(18, distribution_size=4), Column(361, distribution_size=3), Column(19, distribution_size=5), Column(20, distribution_size=5), Column(21, distribution_size=5), Column(22, distribution_size=5), Column(42, distribution_size=5), Column(73, distribution_size=5), Column(470, distribution_size=3), Column(472, distribution_size=3), Column(475, distribution_size=5), Column(477, distribution_size=5), Column(50, distribution_size=6), Column(476, distribution_size=6), Column(478, distribution_size=6), Column(318, distribution_size=44), Column(25, distribution_size=8), Column(51, distribution_size=9), Column(54, distribution_size=9), Column(408, distribution_size=6), Column(474, distribution_size=5), Column(358, distribution_size=7), Column(384, distribution_size=15), Column(14, distribution_size=18), Column(317, distribution_size=15), Column(326, distribution_size=18), Column(350, distribution_size=17), Column(161, distribution_size=18), Column(234, distribution_size=19), Column(148, distribution_size=15), Column(324, distribution_size=20), Column(13, distribution_size=29), Column(147, distribution_size=15), Column(88, distribution_size=22), Column(299, distribution_size=20), Column(316, distribution_size=27), Column(397, distribution_size=35), Column(410, distribution_size=20), Column(288, distribution_size=26), Column(233, distribution_size=28), Column(258, distribution_size=28), Column(183, distribution_size=26), Column(325, distribution_size=27), Column(387, distribution_size=42), Column(182, distribution_size=28), Column(307, distribution_size=28), Column(357, distribution_size=23), Column(314, distribution_size=32), Column(322, distribution_size=34), Column(92, distribution_size=34), Column(304, distribution_size=37), Column(323, distribution_size=31), Column(210, distribution_size=32), Column(93, distribution_size=35), Column(464, distribution_size=25), Column(94, distribution_size=44), Column(255, distribution_size=36), Column(271, distribution_size=35), Column(15, distribution_size=54), Column(219, distribution_size=37), Column(259, distribution_size=41), Column(3, distribution_size=58), Column(294, distribution_size=37), Column(359, distribution_size=38), Column(96, distribution_size=46), Column(209, distribution_size=37), Column(336, distribution_size=33), Column(265, distribution_size=45), Column(319, distribution_size=43), Column(360, distribution_size=40), Column(272, distribution_size=44), Column(277, distribution_size=42)]): 16.5418 bits
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 95413 entries, 0 to 95412
Data columns (total 100 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   473     95413 non-null  object
 1   5       95413 non-null  object
 2   9       95413 non-null  object
 3   10      95413 non-null  object
 4   11      95413 non-null  object
 5   12      95413 non-null  object
 6   52      95413 non-null  object
 7   55      95413 non-null  object
 8   56      95413 non-null  object
 9   57      95413 non-null  object
 10  58      95413 non-null  object
 11  59      95413 non-null  object
 12  60      95413 non-null  object
 13  61      95413 non-null  object
 14  62      95413 non-null  object
 15  63      95413 non-null  object
 16  64      95413 non-null  object
 17  65      95413 non-null  object
 18  66      95413 non-null  object
 19  67      95413 non-null  object
 20  68      95413 non-null  object
 21  69      95413 non-null  object
 22  70      95413 non-null  object
 23  71      95413 non-null  object
 24  72      95413 non-null  object
 25  74      95413 non-null  object
 26  6       95413 non-null  object
 27  17      95413 non-null  object
 28  18      95413 non-null  object
 29  361     95413 non-null  int64 
 30  19      95413 non-null  object
 31  20      95413 non-null  object
 32  21      95413 non-null  object
 33  22      95413 non-null  object
 34  42      95413 non-null  object
 35  73      95413 non-null  object
 36  470     95413 non-null  int64 
 37  472     95413 non-null  int64 
 38  475     95413 non-null  object
 39  477     95413 non-null  object
 40  50      95413 non-null  object
 41  476     95413 non-null  object
 42  478     95413 non-null  object
 43  318     95413 non-null  int64 
 44  25      95413 non-null  object
 45  51      95413 non-null  object
 46  54      95413 non-null  object
 47  408     95413 non-null  int64 
 48  474     95413 non-null  int64 
 49  358     95413 non-null  int64 
 50  384     95413 non-null  object
 51  14      95413 non-null  object
 52  317     95413 non-null  int64 
 53  326     95413 non-null  int64 
 54  350     95413 non-null  int64 
 55  161     95413 non-null  int64 
 56  234     95413 non-null  int64 
 57  148     95413 non-null  int64 
 58  324     95413 non-null  int64 
 59  13      95413 non-null  object
 60  147     95413 non-null  int64 
 61  88      95413 non-null  int64 
 62  299     95413 non-null  int64 
 63  316     95413 non-null  int64 
 64  397     95413 non-null  object
 65  410     95413 non-null  int64 
 66  288     95413 non-null  int64 
 67  233     95413 non-null  int64 
 68  258     95413 non-null  int64 
 69  183     95413 non-null  int64 
 70  325     95413 non-null  int64 
 71  387     95413 non-null  object
 72  182     95413 non-null  int64 
 73  307     95413 non-null  int64 
 74  357     95413 non-null  int64 
 75  314     95413 non-null  int64 
 76  322     95413 non-null  int64 
 77  92      95413 non-null  int64 
 78  304     95413 non-null  int64 
 79  323     95413 non-null  int64 
 80  210     95413 non-null  int64 
 81  93      95413 non-null  int64 
 82  464     95413 non-null  int64 
 83  94      95413 non-null  int64 
 84  255     95413 non-null  int64 
 85  271     95413 non-null  int64 
 86  15      95413 non-null  object
 87  219     95413 non-null  int64 
 88  259     95413 non-null  int64 
 89  3       95413 non-null  object
 90  294     95413 non-null  int64 
 91  359     95413 non-null  int64 
 92  96      95413 non-null  int64 
 93  209     95413 non-null  int64 
 94  336     95413 non-null  int64 
 95  265     95413 non-null  int64 
 96  319     95413 non-null  int64 
 97  360     95413 non-null  int64 
 98  272     95413 non-null  int64 
 99  277     95413 non-null  int64 
dtypes: int64(50), object(50)
memory usage: 72.8+ MB
None
MASK_SCHEME 0
ordering [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71
 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95
 96 97 98 99]
using orig mask
 tensor([[ True, False, False,  ..., False, False, False],
        [ True,  True, False,  ..., False, False, False],
        [ True,  True,  True,  ..., False, False, False],
        ...,
        [ True,  True,  True,  ...,  True, False, False],
        [ True,  True,  True,  ...,  True,  True, False],
        [ True,  True,  True,  ...,  True,  True,  True]])
Number of model parameters: 772480 (~= 2.9MB)
Transformer(
  (blocks): Sequential(
    (0): Block(
      (mlp): Sequential(
        (0): Conv1d()
        (1): GeLU()
        (2): Conv1d()
      )
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (attn): MultiHeadSelfAttention(
        (qkv_linear): Conv1d()
        (linear): Conv1d()
      )
    )
    (1): Block(
      (mlp): Sequential(
        (0): Conv1d()
        (1): GeLU()
        (2): Conv1d()
      )
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (attn): MultiHeadSelfAttention(
        (qkv_linear): Conv1d()
        (linear): Conv1d()
      )
    )
    (2): Block(
      (mlp): Sequential(
        (0): Conv1d()
        (1): GeLU()
        (2): Conv1d()
      )
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (attn): MultiHeadSelfAttention(
        (qkv_linear): Conv1d()
        (linear): Conv1d()
      )
    )
    (3): Block(
      (mlp): Sequential(
        (0): Conv1d()
        (1): GeLU()
        (2): Conv1d()
      )
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (attn): MultiHeadSelfAttention(
        (qkv_linear): Conv1d()
        (linear): Conv1d()
      )
    )
  )
  (norm): LayerNorm()
  (embeddings): ModuleList(
    (0): Embedding(2, 128)
    (1): Embedding(3, 128)
    (2): Embedding(3, 128)
    (3): Embedding(3, 128)
    (4): Embedding(3, 128)
    (5): Embedding(3, 128)
    (6): Embedding(3, 128)
    (7): Embedding(3, 128)
    (8): Embedding(3, 128)
    (9): Embedding(3, 128)
    (10): Embedding(3, 128)
    (11): Embedding(3, 128)
    (12): Embedding(3, 128)
    (13): Embedding(3, 128)
    (14): Embedding(3, 128)
    (15): Embedding(3, 128)
    (16): Embedding(3, 128)
    (17): Embedding(3, 128)
    (18): Embedding(3, 128)
    (19): Embedding(3, 128)
    (20): Embedding(3, 128)
    (21): Embedding(3, 128)
    (22): Embedding(3, 128)
    (23): Embedding(3, 128)
    (24): Embedding(3, 128)
    (25): Embedding(3, 128)
    (26): Embedding(4, 128)
    (27): Embedding(4, 128)
    (28): Embedding(4, 128)
    (29): Embedding(3, 128)
    (30): Embedding(5, 128)
    (31): Embedding(5, 128)
    (32): Embedding(5, 128)
    (33): Embedding(5, 128)
    (34): Embedding(5, 128)
    (35): Embedding(5, 128)
    (36): Embedding(3, 128)
    (37): Embedding(3, 128)
    (38): Embedding(5, 128)
    (39): Embedding(5, 128)
    (40): Embedding(6, 128)
    (41): Embedding(6, 128)
    (42): Embedding(6, 128)
    (43): Embedding(44, 128)
    (44): Embedding(8, 128)
    (45): Embedding(9, 128)
    (46): Embedding(9, 128)
    (47): Embedding(6, 128)
    (48): Embedding(5, 128)
    (49): Embedding(7, 128)
    (50): Embedding(15, 128)
    (51): Embedding(18, 128)
    (52): Embedding(15, 128)
    (53): Embedding(18, 128)
    (54): Embedding(17, 128)
    (55): Embedding(18, 128)
    (56): Embedding(19, 128)
    (57): Embedding(15, 128)
    (58): Embedding(20, 128)
    (59): Embedding(29, 128)
    (60): Embedding(15, 128)
    (61): Embedding(22, 128)
    (62): Embedding(20, 128)
    (63): Embedding(27, 128)
    (64): Embedding(35, 128)
    (65): Embedding(20, 128)
    (66): Embedding(26, 128)
    (67): Embedding(28, 128)
    (68): Embedding(28, 128)
    (69): Embedding(26, 128)
    (70): Embedding(27, 128)
    (71): Embedding(42, 128)
    (72): Embedding(28, 128)
    (73): Embedding(28, 128)
    (74): Embedding(23, 128)
    (75): Embedding(32, 128)
    (76): Embedding(34, 128)
    (77): Embedding(34, 128)
    (78): Embedding(37, 128)
    (79): Embedding(31, 128)
    (80): Embedding(32, 128)
    (81): Embedding(35, 128)
    (82): Embedding(25, 128)
    (83): Embedding(44, 128)
    (84): Embedding(36, 128)
    (85): Embedding(35, 128)
    (86): Embedding(54, 128)
    (87): Embedding(37, 128)
    (88): Embedding(41, 128)
    (89): Embedding(58, 128)
    (90): Embedding(37, 128)
    (91): Embedding(38, 128)
    (92): Embedding(46, 128)
    (93): Embedding(37, 128)
    (94): Embedding(33, 128)
    (95): Embedding(45, 128)
    (96): Embedding(43, 128)
    (97): Embedding(40, 128)
    (98): Embedding(44, 128)
    (99): Embedding(42, 128)
  )
  (pos_embeddings): Embedding(100, 128)
)
Discretizing table... done, took 0.3s
Epoch 0 Iter 0, train entropy gap 329.9001 bits (loss 346.442, data 16.542) 
epoch 0 train loss 100.6018 nats / 145.1377 bits
time since start: 12.6 secs
Epoch 1 Iter 0, train entropy gap 111.5463 bits (loss 128.088, data 16.542) 
epoch 1 train loss 85.2607 nats / 123.0051 bits
time since start: 24.4 secs
Epoch 2 Iter 0, train entropy gap 103.2928 bits (loss 119.835, data 16.542) 
epoch 2 train loss 79.9445 nats / 115.3355 bits
time since start: 36.3 secs
Epoch 3 Iter 0, train entropy gap 96.5110 bits (loss 113.053, data 16.542) 
epoch 3 train loss 77.9745 nats / 112.4935 bits
time since start: 48.1 secs
Epoch 4 Iter 0, train entropy gap 94.0571 bits (loss 110.599, data 16.542) 
epoch 4 train loss 76.4236 nats / 110.2560 bits
time since start: 60.0 secs
Epoch 5 Iter 0, train entropy gap 92.9513 bits (loss 109.493, data 16.542) 
epoch 5 train loss 75.5686 nats / 109.0225 bits
time since start: 71.9 secs
Epoch 6 Iter 0, train entropy gap 91.2414 bits (loss 107.783, data 16.542) 
epoch 6 train loss 74.7188 nats / 107.7964 bits
time since start: 83.7 secs
Epoch 7 Iter 0, train entropy gap 90.9229 bits (loss 107.465, data 16.542) 
epoch 7 train loss 73.8312 nats / 106.5159 bits
time since start: 95.6 secs
Epoch 8 Iter 0, train entropy gap 89.8460 bits (loss 106.388, data 16.542) 
epoch 8 train loss 73.1896 nats / 105.5902 bits
time since start: 107.5 secs
Epoch 9 Iter 0, train entropy gap 88.1782 bits (loss 104.720, data 16.542) 
epoch 9 train loss 72.7495 nats / 104.9553 bits
time since start: 119.3 secs
Epoch 10 Iter 0, train entropy gap 87.8319 bits (loss 104.374, data 16.542) 
epoch 10 train loss 72.2910 nats / 104.2938 bits
time since start: 131.2 secs
Epoch 11 Iter 0, train entropy gap 87.0772 bits (loss 103.619, data 16.542) 
epoch 11 train loss 71.8688 nats / 103.6847 bits
time since start: 143.0 secs
Epoch 12 Iter 0, train entropy gap 86.5021 bits (loss 103.044, data 16.542) 
epoch 12 train loss 71.6532 nats / 103.3737 bits
time since start: 154.9 secs
Epoch 13 Iter 0, train entropy gap 86.1493 bits (loss 102.691, data 16.542) 
epoch 13 train loss 71.3699 nats / 102.9650 bits
time since start: 166.7 secs
Epoch 14 Iter 0, train entropy gap 86.1276 bits (loss 102.669, data 16.542) 
epoch 14 train loss 71.0753 nats / 102.5399 bits
time since start: 178.6 secs
Epoch 15 Iter 0, train entropy gap 86.1924 bits (loss 102.734, data 16.542) 
epoch 15 train loss 70.8867 nats / 102.2679 bits
time since start: 190.4 secs
Epoch 16 Iter 0, train entropy gap 85.1493 bits (loss 101.691, data 16.542) 
epoch 16 train loss 70.6497 nats / 101.9260 bits
time since start: 202.3 secs
Epoch 17 Iter 0, train entropy gap 84.3706 bits (loss 100.912, data 16.542) 
epoch 17 train loss 70.4438 nats / 101.6289 bits
time since start: 214.2 secs
Epoch 18 Iter 0, train entropy gap 85.1995 bits (loss 101.741, data 16.542) 
epoch 18 train loss 70.2397 nats / 101.3345 bits
time since start: 226.0 secs
Epoch 19 Iter 0, train entropy gap 84.4501 bits (loss 100.992, data 16.542) 
epoch 19 train loss 70.0301 nats / 101.0321 bits
time since start: 237.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 69.6808 nats / 100.5282 bits
Saved to:
models/cup-2.9MB-model100.605-data16.542-transformer-blocks4-model128-ff256-heads8-use_flash_attnFalse-posEmb-gelu-20epochs-seed0.pt
